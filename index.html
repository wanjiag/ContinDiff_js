<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="d3/d3.js"></script>
<script src="TimTurkTools.js"></script>

<style type="text/css">
.trialDiv{
	display: none;
	border: 1px solid white;
	border-color: read;
	border-width: 1px;
	padding-left: 0px;
	width: 960px;
	margin: 0 auto;
}
.textBox{
	display: none;
	border: 1px solid white;
	padding-left: 20px;
	width: 500px;
	margin: 0 auto;
	font-family: Arial, Helvetica;
	font-size: 15pt;
}
.images{
	display:inline-block;
	margin-left:10px;
	margin-right:10px;
}
#welcome{
	display: block;
}
#fixation{
	display: none;
	border: 1px solid white;
	border-color: read;
	border-width: 1px;
	padding-left: 0px;
	padding-top: 150px;
	width: 30px;
	margin: 0 auto;
}
</style>


<div class = "textBox" id = "welcome">
	<p>Welcome to the experiment!</p>
	</br>
	<a href="#" id="start">Start</a>
</div>

<div class = "textBox" id = "demographic">
	<p>Before we begin, please complete the following demographic information: </p>
	</br>
	<p>Gender:</p>
	<p><input type="radio" class="demoButton" name="gender" value="1">Male 
		<input type="radio" class="demoButton" name="gender" value="2">Female
		<input type="radio" class="demoButton" name="gender" value="3">Prefer not to answer </p>
	</br>
	<p>Age:</p>
	<p><input type="radio" class="demoButton" name="age" value="1">Less than 18 
		<input type="radio" class="demoButton" name="age" value="2">18-25 
		<input type="radio" class="demoButton" name="age" value="3">26-35 
		<input type="radio" class="demoButton" name="age" value="4">36-60 
		<input type="radio" class="demoButton" name="age" value="5">61+ 
	</br>
	</br>
	<a href="#" id="showinstructions">Continue.</a>
</div>

<div class = "textBox" id = "instructions">
	<p>Thank you for participating! Before we begin, please make sure you are in a quiet location where you will not be distracted or disturbed for the next 25 minutes. Please close other windows. The experiment runs fastest when other programs are closed. </p>
	<p>In this experiment, 3 pictures will appear on the screen. Please try your best to memorize these 3 pictures. Then, 3 scrambled pictures will appear and take place of the 3 pictures. Lastly, one of the 3 scrambled pictures will change into a new picture, and you will need to judge whether the picture is the same or different from the previous picture that was on the same place.</p>
	<p>If the picture is <strong>the same</strong>, press the letter J.</p>
	<p>If the picture is <strong>different</strong>, press the letter K.</p>
	</br>
	</br>
	<p><b>Press the space bar to start.</b></p>
</div>

<div id="scrambled" class="trialDiv">
	<p><img class="images" src="stimuli/scrambled.jpg"  width="300"><img class="images" src="stimuli/scrambled.jpg"  width="300"><img class="images" src="stimuli/scrambled.jpg"  width="300"></p>
</div> 

<div id="fixation" class="trialDiv">
	<p><img class="images" src="stimuli/fixation.png"  width="30" left></p>
</div> 

<div id="firstdisplay" class="trialDiv">
	<p><img class="images" id = "img1_1" width="300"><img class="images" id = "img1_2" width="300"><img class="images" id="img1_3" width="300"></p>
</div> 

<div id="seconddisplay" class="trialDiv">
	<p><img class="images" id = "img2_1" width="300"><img class="images" id = "img2_2" width="300"><img class="images" id="img2_3" width="300"></p>
</div> 

<input type="hidden" id="subgender" name="subgender" value="">
<input type="hidden" id="subage" name="subage" value="">

<script>
	var sub_gender
	var sub_age

    $(document).ready(function(){
        $('#showinstructions').click(function(){
        	sub_gender = $("input[name='gender']:checked").val();
        	$('#subgender').val(sub_gender)
        	sub_age = $("input[name='age']:checked").val()
        	$('#subage').val(sub_age)
            alert("Your are a - " + sub_gender + " " + sub_age);
        });
    });

	var currentTrial = 0;
	var data;
	var respwindow = false;

	d3.csv("./sub_file/sub01.csv").then(function(subdata) {
		data = subdata
	});

	function showDemo(){
		$('#demographic').show();
		$('#welcome').hide();
	}
	function showInstructions(){
		$('#instructions').show();
		$('#demographic').hide();
	}

	function pressedSame(){
		//$('#t' + currentTrial + 'response').val('j')
		$("#seconddisplay").hide();

		var input = document.createElement("input");
		input.setAttribute("type", "hidden");
		input.setAttribute("name", "resp"+currentTrial);
		input.setAttribute("value", "j");

		NextTrial();

	}

	function pressedDiff(){
		//$('#t' + currentTrial + 'response').val('k');
		$("#seconddisplay").hide();

		var input = document.createElement("input");
		input.setAttribute("type", "hidden");
		input.setAttribute("name", "resp"+currentTrial);
		input.setAttribute("value", "k");

		NextTrial();
	}


	function NextTrial(){

		$('#fixation').show();

		document.getElementById("img1_"+data[currentTrial].locy).src = data[currentTrial].first_pic;
		document.getElementById("img1_"+data[currentTrial].loc2y).src = data[currentTrial].lure1;
		document.getElementById("img1_"+data[currentTrial].loc3y).src = data[currentTrial].lure2;

		document.getElementById('img2_'+data[currentTrial].locy).src = data[currentTrial].second_pic;
		document.getElementById('img2_'+data[currentTrial].loc2y).src = "stimuli/scrambled.jpg";
		document.getElementById('img2_'+data[currentTrial].loc3y).src = "stimuli/scrambled.jpg";
				
		setTimeout(function(){$("#fixation").hide();
		                      $("#firstdisplay").show();}, 1000);
				
		setTimeout(function(){$("#firstdisplay").hide();
						      $("#scrambled").show();}, 2500);

		setTimeout(function(){$("#scrambled").hide();
		                      $("#seconddisplay").show();}, 3500);

		setTimeout(function(){$("#seconddisplay").hide();}, 5500);

		currentTrial++;

	}


	function showFirsttrial(){

		$('#instructions').hide();
		$('#fixation').show();

		document.getElementById("img1_"+data[0].locy).src = data[0].first_pic;
		document.getElementById("img1_"+data[0].loc2y).src = data[0].lure1;
		document.getElementById("img1_"+data[0].loc3y).src = data[0].lure2;

		document.getElementById('img2_'+data[0].locy).src = data[0].second_pic;
		document.getElementById('img2_'+data[0].loc2y).src = "stimuli/scrambled.jpg";
		document.getElementById('img2_'+data[0].loc3y).src = "stimuli/scrambled.jpg";
				
		setTimeout(function(){$("#fixation").hide();
		                      $("#firstdisplay").show();}, 1000);
				
		setTimeout(function(){$("#firstdisplay").hide();
						      $("#scrambled").show();}, 2500);

		setTimeout(function(){$("#scrambled").hide();
		                      $("#seconddisplay").show();}, 3500);

		setTimeout(function(){$("#seconddisplay").hide();}, 5500);

		currentTrial++;
	}


	function buttonClicked() {
		$('#testtrial'+curTrial).hide();
		curTrial++;
		$('#testtrial'+curTrial).show();
	}
	$(document).ready(function(){
		$('#start').click(showDemo);
		$('#showinstructions').click(showInstructions);
		$(document).bind('keyup', 'space', showFirsttrial);
		$(document).bind('keyup', 'j', pressedSame);
		$(document).bind('keyup', 'k', pressedDiff);
		//$('.responseButton').click(buttonClicked);
	});

</script>